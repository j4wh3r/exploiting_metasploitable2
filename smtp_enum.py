import  socket
import sys
import os


def err_msg():
        print("Usage ./smtp-enum.py <ip> <wordlist>")
        exit(0)
if len(sys.argv) != 3:
        err_msg()

print("done")


ip = sys.argv[1]
port = 25



if os.path.exists(sys.argv[2]):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((ip, port))
        banner = s.recv(1024)
        print(banner)

        f = open(sys.argv[2],"r")
        cmd = "VRFY "
        for i in f.readlines():
                data = cmd + i + '\r\n'
                s.send(data.encode())
                result = s.recv(1024).decode()
                if result[0:3] == "252":
                        print("[*]user ", i ," exists")
        f.close()
else:
        err_msg()

